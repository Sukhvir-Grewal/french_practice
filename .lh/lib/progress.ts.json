{
    "sourceFile": "lib/progress.ts",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1767726896664,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1767726896664,
            "name": "Commit-0",
            "content": "// localStorage utility functions for app state\r\n\r\nexport interface ProgressData {\r\n  completedSounds: number[];\r\n  lastViewedSound: number;\r\n  practiceHistory: PracticeSession[];\r\n  playbackSpeed: number;\r\n}\r\n\r\nexport interface PracticeSession {\r\n  date: string;\r\n  correctCount: number;\r\n  totalWords: number;\r\n  timestamp: number;\r\n}\r\n\r\nconst STORAGE_KEY = \"frenchPracticeApp\";\r\n\r\n// Get all progress data\r\nexport const getProgress = (): ProgressData => {\r\n  if (typeof window === \"undefined\") return getDefaultProgress();\r\n  \r\n  try {\r\n    const data = localStorage.getItem(STORAGE_KEY);\r\n    if (!data) return getDefaultProgress();\r\n    return JSON.parse(data);\r\n  } catch (error) {\r\n    console.error(\"Error reading progress:\", error);\r\n    return getDefaultProgress();\r\n  }\r\n};\r\n\r\n// Save progress data\r\nexport const saveProgress = (progress: ProgressData): void => {\r\n  if (typeof window === \"undefined\") return;\r\n  \r\n  try {\r\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(progress));\r\n  } catch (error) {\r\n    console.error(\"Error saving progress:\", error);\r\n  }\r\n};\r\n\r\n// Mark a sound as completed\r\nexport const markSoundCompleted = (soundId: number): void => {\r\n  const progress = getProgress();\r\n  if (!progress.completedSounds.includes(soundId)) {\r\n    progress.completedSounds.push(soundId);\r\n    saveProgress(progress);\r\n  }\r\n};\r\n\r\n// Update last viewed sound\r\nexport const updateLastViewedSound = (soundId: number): void => {\r\n  const progress = getProgress();\r\n  progress.lastViewedSound = soundId;\r\n  saveProgress(progress);\r\n};\r\n\r\n// Save practice session result\r\nexport const savePracticeSession = (correctCount: number, totalWords: number): void => {\r\n  const progress = getProgress();\r\n  const session: PracticeSession = {\r\n    date: new Date().toLocaleDateString(),\r\n    correctCount,\r\n    totalWords,\r\n    timestamp: Date.now(),\r\n  };\r\n  progress.practiceHistory.push(session);\r\n  // Keep only last 50 sessions\r\n  if (progress.practiceHistory.length > 50) {\r\n    progress.practiceHistory = progress.practiceHistory.slice(-50);\r\n  }\r\n  saveProgress(progress);\r\n};\r\n\r\n// Get/Set playback speed\r\nexport const getPlaybackSpeed = (): number => {\r\n  return getProgress().playbackSpeed;\r\n};\r\n\r\nexport const setPlaybackSpeed = (speed: number): void => {\r\n  const progress = getProgress();\r\n  progress.playbackSpeed = speed;\r\n  saveProgress(progress);\r\n};\r\n\r\n// Helper to get default progress\r\nconst getDefaultProgress = (): ProgressData => ({\r\n  completedSounds: [],\r\n  lastViewedSound: 0,\r\n  practiceHistory: [],\r\n  playbackSpeed: 0.8, // Default: slightly slower\r\n});\r\n\r\n// Get stats\r\nexport const getStats = () => {\r\n  const progress = getProgress();\r\n  const totalSessions = progress.practiceHistory.length;\r\n  const totalCorrect = progress.practiceHistory.reduce((sum, s) => sum + s.correctCount, 0);\r\n  const totalWords = progress.practiceHistory.reduce((sum, s) => sum + s.totalWords, 0);\r\n  const averageScore = totalWords > 0 ? Math.round((totalCorrect / totalWords) * 100) : 0;\r\n  \r\n  return {\r\n    completedSounds: progress.completedSounds.length,\r\n    totalSessions,\r\n    averageScore,\r\n  };\r\n};\r\n"
        }
    ]
}